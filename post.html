<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post - Big Duck</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo"><img src="images/logo/logo.png" alt="Logo" class="logo-img"><span>Big Duck</span></div>
            <nav>
                <ul><li><a href="blog.html"><span class="hash"><</span> back-to-blog</a></li></ul>
            </nav>
        </header>

        <article class="post-container">
            <div class="post-hero">
                <img id="post-image" src="" alt="Hero Image">
            </div>

            <div class="post-header">
                <div class="post-info">
                    <span id="post-category" class="post-badge">Category</span>
                    <span id="post-date" class="post-meta">Date</span>
                </div>
                <h1 id="post-title" class="font-text">Loading...</h1>
            </div>
            
            <div class="post-divider"></div>

            <div id="post-content" class="post-body font-text">
                </div>
        </article>

        <section class="related-section">
            <h3 class="related-title">Bài viết liên quan</h3>
            <div id="related-list" class="related-grid">
                </div>
        </section>

        <footer>
            <div class="copyright">© Copyright 2025. Made by Đức</div>
        </footer>
    </div>

    <script src="blog-data.js"></script>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const postId = urlParams.get('id');
        const post = blogPosts.find(p => p.id === postId);

        if (post) {
            // Load nội dung bài hiện tại
            document.title = post.title + " - Duc's Blog";
            document.getElementById('post-image').src = post.image; // Load ảnh bìa
            document.getElementById('post-title').innerText = post.title;
            document.getElementById('post-date').innerText = post.date;
            document.getElementById('post-category').innerText = post.category.toUpperCase();
            document.getElementById('post-content').innerHTML = post.content;

            // --- XỬ LÝ BÀI LIÊN QUAN (RELATED POSTS) ---
            const relatedContainer = document.getElementById('related-list');
            
            // Lọc các bài cùng category nhưng KHÔNG trùng bài hiện tại
            const relatedPosts = blogPosts
                .filter(p => p.category === post.category && p.id !== post.id)
                .slice(0, 3); // Chỉ lấy tối đa 3 bài

            if (relatedPosts.length > 0) {
                relatedPosts.forEach(rp => {
                    const rCard = document.createElement('div');
                    rCard.className = 'related-card';
                    rCard.innerHTML = `
                        <a href="post.html?id=${rp.id}" class="related-thumb">
                            <img src="${rp.image}" alt="${rp.title}">
                        </a>
                        <div class="related-content">
                            <h4><a href="post.html?id=${rp.id}" class="font-text">${rp.title}</a></h4>
                            <span class="related-date">${rp.date}</span>
                        </div>
                    `;
                    relatedContainer.appendChild(rCard);
                });
            } else {
                relatedContainer.innerHTML = '<p style="color:var(--gray)">Không có bài viết liên quan.</p>';
            }

        } else {
            document.getElementById('post-content').innerHTML = "<h1>404</h1><p>Bài viết không tồn tại.</p>";
            document.getElementById('post-image').style.display = 'none';
        }
    </script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Tạo thẻ canvas
        var canvas = document.createElement("canvas");
        canvas.style.position = "fixed";
        canvas.style.top = "0";
        canvas.style.left = "0";
        canvas.style.width = "100%";
        canvas.style.height = "100%";
        canvas.style.pointerEvents = "none"; // Để tuyết không chặn chuột click
        canvas.style.zIndex = "9999"; // Đè lên mọi thứ (nếu muốn tuyết rơi sau chữ thì đổi thành -1)
        document.body.appendChild(canvas);

        var ctx = canvas.getContext("2d");
        var width = window.innerWidth;
        var height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;

        // Cấu hình số lượng và tốc độ tuyết
        var maxFlakes = 100; // Số lượng bông tuyết (giảm nếu lag)
        var flakes = [];

        // Tạo mảng bông tuyết
        for (var i = 0; i < maxFlakes; i++) {
            flakes.push({
                x: Math.random() * width,
                y: Math.random() * height,
                r: Math.random() * 2 + 1, // Kích thước bông tuyết (1px - 3px)
                d: Math.random() + 1      // Tỷ trọng (tốc độ rơi)
            });
        }

        // Hàm vẽ tuyết
        function drawFlakes() {
            ctx.clearRect(0, 0, width, height);
            ctx.fillStyle = "rgba(255, 255, 255, 0.8)"; // Màu trắng, hơi mờ
            ctx.beginPath();
            
            for (var i = 0; i < maxFlakes; i++) {
                var f = flakes[i];
                ctx.moveTo(f.x, f.y);
                ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2, true);
            }
            ctx.fill();
            moveFlakes();
        }

        // Hàm di chuyển tuyết
        var angle = 0;
        function moveFlakes() {
            angle += 0.01;
            for (var i = 0; i < maxFlakes; i++) {
                var f = flakes[i];
                
                // Cập nhật vị trí Y (rơi xuống) và X (lắc lư theo gió)
                f.y += Math.pow(f.d, 2) + 1; // Tốc độ rơi
                f.x += Math.sin(angle) * 2;

                // Nếu tuyết rơi xuống đáy, đưa nó lên lại đỉnh
                if (f.y > height) {
                    flakes[i] = {
                        x: Math.random() * width,
                        y: 0,
                        r: f.r,
                        d: f.d
                    };
                }
            }
        }

        // Vòng lặp animation
        setInterval(drawFlakes, 25);

        // Xử lý khi co giãn màn hình
        window.onresize = function() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
    });
</script>
</body>
</html>